Param(
    [Parameter(Mandatory=$True)]
    [string]$port
)

$ips = @('10.163.221.180',
'10.225.221.180',
'10.193.221.180',
'10.178.34.180',
'10.193.227.180',
'10.55.61.170',
'172.17.7.170',
'172.17.71.170',
'172.31.16.23',
'10.241.221.180',
'10.19.221.161',
'10.145.221.180',
'10.147.221.170',
'172.17.39.170',
'10.185.221.180',
'10.209.221.170',
'10.9.221.180',
'10.1.221.180',
'10.81.221.170',
'172.31.0.40',
'10.73.221.170',
'10.65.221.170',
'172.19.71.170',
'10.49.221.170',
'10.33.221.180',
'10.23.221.170',
'172.17.199.170',
'172.17.231.170',
'10.205.221.170',
'172.18.7.170',
'172.31.2.23')

$nc = ""

ForEach ($ip in $ips)
{
    C:\Users\atyagi\Downloads\netcat-win32-1.12\nc.exe -z $ip $port
    if ( $? -eq 'True' ) {
        write-Host $ip ": Connected"
    }
    else {
        Write-Host $ip ": Not Connected"
    }
}